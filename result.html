<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>診断結果｜もみ徳スタッフマッチング</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 2rem 1rem; color: #333; }
    h1 { text-align: center; margin-bottom: 2rem; font-size: 1.8rem; }
    .results { max-width: 800px; margin: auto; display: flex; flex-direction: column; gap: 1.5rem; }
    .card { background: #fff; padding: 1.2rem; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: flex; gap: 1rem; align-items: center; }
    .card img { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; }
    .info { flex: 1; }
    .info h2 { margin: 0 0 0.3rem; font-size: 1.2rem; }
    .info p { margin: 0.2rem 0; font-size: 0.95rem; }
    .info a { margin-top: 0.5rem; display: inline-block; background: #3b7ddd; color: white; padding: 0.4rem 0.8rem; border-radius: 5px; text-decoration: none; font-size: 0.9rem; }
    .score { font-weight: bold; font-size: 1.1rem; color: #3b7ddd; }
  </style>
</head>
<body>
  <h1>診断結果</h1>

  <div class="results" id="results"></div>

  <script>
    // スタッフデータ（仮）
    const staffList = [
      {
        name: "たろう",
        gender: "male",
        area: "kumomizaka",
        skills: ["korini", "chikara", "sukkiri"],
        image: "https://placehold.jp/100x100.png",
        url: "tarou.html"
      },
      {
        name: "みき",
        gender: "female",
        area: "nagigahara",
        skills: ["teinei", "waza", "sukkiri"],
        image: "https://placehold.jp/100x100.png",
        url: "miki.html"
      },
      {
        name: "ゆい",
        gender: "female",
        area: "hoshikage",
        skills: ["korini", "rakuni", "teinei"],
        image: "https://placehold.jp/100x100.png",
        url: "yui.html"
      },
      {
        name: "はるか",
        gender: "female",
        area: "akanedani",
        skills: ["waza", "korini", "sukkiri"],
        image: "https://placehold.jp/100x100.png",
        url: "haruka.html"
      },
      {
        name: "けんた",
        gender: "male",
        area: "kohou",
        skills: ["chikara", "korini", "waza"],
        image: "https://placehold.jp/100x100.png",
        url: "kenta.html"
      },
      {
        name: "そうた",
        gender: "male",
        area: "suzuha",
        skills: ["rakuni", "teinei", "sukkiri"],
        image: "https://placehold.jp/100x100.png",
        url: "souta.html"
      }
    ];

    // URLパラメータ取得
    const params = new URLSearchParams(location.search);
    const area = params.get("area");
    const gender = params.get("gender");
    const p1 = params.get("priority1");
    const p2 = params.get("priority2");
    const p3 = params.get("priority3");

    function calcScore(staff) {
      let score = 0;
      let matches = [];
      if (staff.skills.includes(p1)) { score += 3; matches.push(p1); }
      if (staff.skills.includes(p2)) { score += 2; matches.push(p2); }
      if (staff.skills.includes(p3)) { score += 1; matches.push(p3); }
      return { ...staff, score, matches };
    }

    let matched = staffList
      .filter(s => !gender || s.gender === gender)
      .filter(s => !area || s.area === area)
      .map(calcScore)
      .filter(s => s.score > 0)
      .sort((a, b) => b.score - a.score);

    const container = document.getElementById("results");

    if (matched.length === 0) {
      container.innerHTML = "<p>条件に合うスタッフが見つかりませんでした。</p>";
    } else {
      matched.forEach(s => {
        container.innerHTML += `
          <div class="card">
            <img src="${s.image}" alt="${s.name}">
            <div class="info">
              <h2>${s.name}</h2>
              <p>店舗：${s.area} / 性別：${s.gender === "male" ? "男性" : "女性"}</p>
              <p class="score">マッチスコア：${s.score}点</p>
              <p>一致した条件：${s.matches.map(m => skillLabel(m)).join("・")}</p>
              <a href="${s.url}">詳しく見る</a>
            </div>
          </div>
        `;
      });
    }

    function skillLabel(code) {
      return {
        korini: "コリに的確",
        chikara: "力強い",
        rakuni: "動作が楽に",
        sukkiri: "スッキリ",
        teinei: "丁寧な接客",
        waza: "ワザが凄い"
      }[code] || code;
    }
  </script>
</body>
</html>
